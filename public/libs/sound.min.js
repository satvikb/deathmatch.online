function makeSound(a,b,c,d){var e={};return e.volumeNode=actx.createGain(),actx.createStereoPanner?e.panNode=actx.createStereoPanner():e.panNode=actx.createPanner(),e.delayNode=actx.createDelay(),e.feedbackNode=actx.createGain(),e.filterNode=actx.createBiquadFilter(),e.convolverNode=actx.createConvolver(),e.soundNode=null,e.buffer=null,e.source=a,e.loop=!1,e.playing=!1,e.loadHandler=void 0,e.panValue=0,e.volumeValue=1,e.startTime=0,e.startOffset=0,e.playbackRate=1,e.echo=!1,e.delayValue=.3,e.feebackValue=.3,e.filterValue=0,e.reverb=!1,e.reverbImpulse=null,e.play=function(){e.startTime=actx.currentTime,e.soundNode=actx.createBufferSource(),e.soundNode.buffer=e.buffer,e.soundNode.playbackRate.value=this.playbackRate,e.soundNode.connect(e.volumeNode),e.reverb===!1?e.volumeNode.connect(e.panNode):(e.volumeNode.connect(e.convolverNode),e.convolverNode.connect(e.panNode),e.convolverNode.buffer=e.reverbImpulse),e.panNode.connect(actx.destination),e.echo&&(e.feedbackNode.gain.value=e.feebackValue,e.delayNode.delayTime.value=e.delayValue,e.filterNode.frequency.value=e.filterValue,e.delayNode.connect(e.feedbackNode),e.filterValue>0?(e.feedbackNode.connect(e.filterNode),e.filterNode.connect(e.delayNode)):e.feedbackNode.connect(e.delayNode),e.volumeNode.connect(e.delayNode),e.delayNode.connect(e.panNode)),e.soundNode.loop=e.loop,e.soundNode.start(0,e.startOffset%e.buffer.duration),e.playing=!0},e.pause=function(){e.playing&&(e.soundNode.stop(0),e.startOffset+=actx.currentTime-e.startTime,e.playing=!1)},e.restart=function(){e.playing&&e.soundNode.stop(0),e.startOffset=0,e.play()},e.playFrom=function(a){e.playing&&e.soundNode.stop(0),e.startOffset=a,e.play()},e.setEcho=function(a,b,c){void 0===a&&(a=.3),void 0===b&&(b=.3),void 0===c&&(c=0),e.delayValue=a,e.feebackValue=b,e.filterValue=c,e.echo=!0},e.setReverb=function(a,b,c){void 0===a&&(a=2),void 0===b&&(b=2),void 0===c&&(c=!1),e.reverbImpulse=impulseResponse(a,b,c,actx),e.reverb=!0},e.fade=function(a,b){e.playing&&(e.volumeNode.gain.linearRampToValueAtTime(e.volumeNode.gain.value,actx.currentTime),e.volumeNode.gain.linearRampToValueAtTime(a,actx.currentTime+b))},e.fadeIn=function(a){e.volumeNode.gain.value=0,e.fade(1,a)},e.fadeOut=function(a){e.fade(0,a)},Object.defineProperties(e,{volume:{get:function(){return e.volumeValue},set:function(a){e.volumeNode.gain.value=a,e.volumeValue=a},enumerable:!0,configurable:!0},pan:{get:function(){return actx.createStereoPanner?e.panNode.pan.value:e.panValue},set:function(a){if(actx.createStereoPanner)e.panNode.pan.value=a;else{var b=a,c=0,d=1-Math.abs(b);e.panNode.setPosition(b,c,d),e.panValue=a}},enumerable:!0,configurable:!0}}),c&&this.loadSound(e,a,b),d&&this.decodeAudio(e,d,b),e}function loadSound(a,b,c){var d=new XMLHttpRequest;d.open("GET",b,!0),d.responseType="arraybuffer",d.addEventListener("load",decodeAudio.bind(this,a,d,c)),d.send()}function decodeAudio(a,b,c){actx.decodeAudioData(b.response,function(b){a.buffer=b,a.hasLoaded=!0,c&&c()},function(a){throw new Error("Audio could not be decoded: "+a)})}function soundEffect(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function t(a){var b=actx.createConvolver();b.buffer=impulseResponse(m[0],m[1],m[2],actx),a.connect(b),b.connect(q)}function u(a){var b=actx.createGain(),c=actx.createDelay(),d=actx.createBiquadFilter();c.delayTime.value=l[0],b.gain.value=l[1],l[2]&&(d.frequency.value=l[2]),c.connect(b),l[2]?(b.connect(d),d.connect(c)):b.connect(c),a.connect(c),c.connect(q)}function v(a){a.gain.value=0,a.gain.linearRampToValueAtTime(0,actx.currentTime+g),a.gain.linearRampToValueAtTime(e,actx.currentTime+g+b)}function w(a){a.gain.linearRampToValueAtTime(e,actx.currentTime+b+g),a.gain.linearRampToValueAtTime(0,actx.currentTime+g+b+c)}function x(a){var d=a.frequency.value;i?(a.frequency.linearRampToValueAtTime(d,actx.currentTime+g),a.frequency.linearRampToValueAtTime(d+h,actx.currentTime+g+b+c)):(a.frequency.linearRampToValueAtTime(d,actx.currentTime+g),a.frequency.linearRampToValueAtTime(d-h,actx.currentTime+g+b+c))}function y(){var a=actx.createOscillator(),d=actx.createOscillator(),f=actx.createGain(),g=actx.createGain();f.gain.value=e,g.gain.value=e,a.connect(f),f.connect(actx.destination),d.connect(g),g.connect(actx.destination),a.type="sawtooth",d.type="sawtooth",a.frequency.value=r+k,d.frequency.value=r-k,b>0&&(v(f),v(g)),c>0&&(w(f),w(g)),h>0&&(x(a),x(d)),l&&(u(f),u(g)),m&&(t(f),t(g)),z(a),z(d)}function z(a){a.start(actx.currentTime+g),a.stop(actx.currentTime+g+2)}void 0===a&&(a=200),void 0===b&&(b=0),void 0===c&&(c=1),void 0===d&&(d="sine"),void 0===e&&(e=1),void 0===f&&(f=0),void 0===g&&(g=0),void 0===h&&(h=0),void 0===i&&(i=!1),void 0===j&&(j=0),void 0===k&&(k=0),void 0===l&&(l=void 0),void 0===m&&(m=void 0),void 0===n&&(n=void 0);var o,p,q;o=actx.createOscillator(),p=actx.createGain(),q=actx.createStereoPanner?actx.createStereoPanner():actx.createPanner(),o.connect(p),p.connect(q),q.connect(actx.destination),p.gain.value=e,actx.createStereoPanner?q.pan.value=f:q.setPosition(f,0,1-Math.abs(f)),o.type=d;var r,s=function(a,b){return Math.floor(Math.random()*(b-a+1))+a};r=j>0?s(a-j/2,a+j/2):a,o.frequency.value=r,b>0&&v(p),w(p),h>0&&x(o),l&&u(p),m&&t(p),k>0&&y(),z(o)}function impulseResponse(a,b,c,d){for(var e=d.sampleRate*a,f=d.createBuffer(2,e,d.sampleRate),g=f.getChannelData(0),h=f.getChannelData(1),i=0;i<e;i++){var j;j=c?e-i:i,g[i]=(2*Math.random()-1)*Math.pow(1-j/e,b),h[i]=(2*Math.random()-1)*Math.pow(1-j/e,b)}return f}function keyboard(a){var b={};return b.code=a,b.isDown=!1,b.isUp=!0,b.press=void 0,b.release=void 0,b.downHandler=function(a){a.keyCode===b.code&&(b.isUp&&b.press&&b.press(),b.isDown=!0,b.isUp=!1),a.preventDefault()},b.upHandler=function(a){a.keyCode===b.code&&(b.isDown&&b.release&&b.release(),b.isDown=!1,b.isUp=!0),a.preventDefault()},window.addEventListener("keydown",b.downHandler.bind(b),!1),window.addEventListener("keyup",b.upHandler.bind(b),!1),b}!function(a,b,c){"use strict";function d(a){a&&(a.setTargetAtTime||(a.setTargetAtTime=a.setTargetValueAtTime))}window.hasOwnProperty("webkitAudioContext")&&!window.hasOwnProperty("AudioContext")&&(window.AudioContext=webkitAudioContext,AudioContext.prototype.hasOwnProperty("createGain")||(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),AudioContext.prototype.hasOwnProperty("createDelay")||(AudioContext.prototype.createDelay=AudioContext.prototype.createDelayNode),AudioContext.prototype.hasOwnProperty("createScriptProcessor")||(AudioContext.prototype.createScriptProcessor=AudioContext.prototype.createJavaScriptNode),AudioContext.prototype.hasOwnProperty("createPeriodicWave")||(AudioContext.prototype.createPeriodicWave=AudioContext.prototype.createWaveTable),AudioContext.prototype.internal_createGain=AudioContext.prototype.createGain,AudioContext.prototype.createGain=function(){var a=this.internal_createGain();return d(a.gain),a},AudioContext.prototype.internal_createDelay=AudioContext.prototype.createDelay,AudioContext.prototype.createDelay=function(a){var b=a?this.internal_createDelay(a):this.internal_createDelay();return d(b.delayTime),b},AudioContext.prototype.internal_createBufferSource=AudioContext.prototype.createBufferSource,AudioContext.prototype.createBufferSource=function(){var a=this.internal_createBufferSource();return a.start?(a.internal_start=a.start,a.start=function(b,c,d){"undefined"!=typeof d?a.internal_start(b||0,c,d):a.internal_start(b||0,c||0)}):a.start=function(a,b,c){b||c?this.noteGrainOn(a||0,b,c):this.noteOn(a||0)},a.stop?(a.internal_stop=a.stop,a.stop=function(b){a.internal_stop(b||0)}):a.stop=function(a){this.noteOff(a||0)},d(a.playbackRate),a},AudioContext.prototype.internal_createDynamicsCompressor=AudioContext.prototype.createDynamicsCompressor,AudioContext.prototype.createDynamicsCompressor=function(){var a=this.internal_createDynamicsCompressor();return d(a.threshold),d(a.knee),d(a.ratio),d(a.reduction),d(a.attack),d(a.release),a},AudioContext.prototype.internal_createBiquadFilter=AudioContext.prototype.createBiquadFilter,AudioContext.prototype.createBiquadFilter=function(){var a=this.internal_createBiquadFilter();return d(a.frequency),d(a.detune),d(a.Q),d(a.gain),a},AudioContext.prototype.hasOwnProperty("createOscillator")&&(AudioContext.prototype.internal_createOscillator=AudioContext.prototype.createOscillator,AudioContext.prototype.createOscillator=function(){var a=this.internal_createOscillator();return a.start?(a.internal_start=a.start,a.start=function(b){a.internal_start(b||0)}):a.start=function(a){this.noteOn(a||0)},a.stop?(a.internal_stop=a.stop,a.stop=function(b){a.internal_stop(b||0)}):a.stop=function(a){this.noteOff(a||0)},a.setPeriodicWave||(a.setPeriodicWave=a.setWaveTable),d(a.frequency),d(a.detune),a})),window.hasOwnProperty("webkitOfflineAudioContext")&&!window.hasOwnProperty("OfflineAudioContext")&&(window.OfflineAudioContext=webkitOfflineAudioContext)}(window);var actx=new AudioContext,sounds={toLoad:0,loaded:0,audioExtensions:["mp3","ogg","wav","webm"],whenLoaded:void 0,load:function(a){console.log("Loading sounds..");var b=this;b.toLoad=a.length,a.forEach(function(a){var c=a.split(".").pop();if(b.audioExtensions.indexOf(c)!==-1){var d=makeSound(a,b.loadHandler.bind(b),!0,!1);d.name=a,b[d.name]=d}else console.log("File type not recognized: "+a)})},loadHandler:function(){var a=this;a.loaded+=1,console.log(a.loaded),a.toLoad===a.loaded&&(console.log("Sounds finished loading"),a.toLoad=0,a.loaded=0,a.whenLoaded())}};